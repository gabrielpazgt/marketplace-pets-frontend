<aside class="summary">
  <!-- Totales + Checkout -->
  <div class="panel totals">
    <h4>Resumen</h4>

    <div class="split">
      <span>Subtotal</span>
      <strong>{{ subtotal$ | async | currency:'GTQ':'symbol-narrow':'1.0-0' }}</strong>
    </div>
    <div class="split">
      <span>Descuento</span>
      <strong>âˆ’{{ discount$ | async | currency:'GTQ':'symbol-narrow':'1.0-0' }}</strong>
    </div>
    <div class="split">
      <span>EnvÃ­o</span>
      <strong>{{ shipping$ | async | currency:'GTQ':'symbol-narrow':'1.0-0' }}</strong>
    </div>

    <hr>

    <div class="split total">
      <span>Total</span>
      <strong>{{ total$ | async | currency:'GTQ':'symbol-narrow':'1.0-0' }}</strong>
    </div>

    <!-- ðŸ‘‡ NUEVO: solo mostramos el total con membresÃ­a -->
    <div class="split member-total">
      <span>Total membresÃ­a</span>
      <strong>{{ memberTotal$ | async | currency:'GTQ':'symbol-narrow':'1.0-0' }}</strong>
    </div>

    <!-- Ahorro (solo si aplica) -->
    <ng-container *ngIf="(total$ | async) as t">
      <ng-container *ngIf="(memberTotal$ | async) as mt">
        <p class="save" *ngIf="t > mt">
          Ahorras <strong class="save__amount">{{ (t - mt) | currency:'GTQ':'symbol-narrow':'1.0-0' }}</strong> con tu membresÃ­a.
        </p>
      </ng-container>
    </ng-container>

    <!-- CTA -->
    <button
      class="cta button_pay"
      [disabled]="!(hasItems$ | async)"
      aria-label="Pagar ahora"
      (click)="checkout()">
      Pagar ahora
    </button>

    <p class="hint">Pagos seguros con tarjetas y transferencias.</p>
  </div>

  <!-- Promo code -->
  <div class="panel promo">
    <div class="promo__header">
      <h5>Â¿Tienes un cÃ³digo?</h5>
    </div>

    <div class="row">
      <input type="text" placeholder="CÃ³digo de descuento" [formControl]="form.controls.code">
      <button class="btn" (click)="apply()">Aplicar</button>
    </div>

    <div class="coupon" *ngIf="(coupon$ | async) as c">
      <span class="ticket">CUPÃ“N: {{ c }}</span>
      <button class="link" (click)="clearCoupon()">Quitar</button>
    </div>
  </div>
</aside>
